## 为啥远程服务调用选型 gRPC

远程服务调用功能，在我接触的游戏架构中，均选择了 gRPC，这不禁让我思考，为什么要有远程服务调用、为什么选择 gRPC？

先来看第一个问题，远程服务调用在游戏中解决了什么问题？

目前我一个场景就需要用到，在 GM Node(游戏运营管理节点) 操作玩家数据，当玩家在线时，需要即时通知玩家（在线玩家在其他节点）。

跨节点的通信，均基于套接字 Socket，假如未跨节点，仅跨进程，Socket 也是优化过的，不会经过网络协议栈和打包拆包等操作。

至此，我们得出一个结论，远程服务调用是为了解决游戏架构中的跨节点通信。

第二个问题，为什么选择 gRPC ？

先说结论，为了性能。

现代跨界点通信，需要解决三个问题，如下。
- 如何表示数据?
表示数据指的就是，序列化和反序列化。gRPC 给出的答案是：Protocl Buffers
- 如何传递数据？
gRPC 传输层基于 TCP，应用层基于 HTTP/2。为什么会选择 HTTP/2？前面提到，选择 gRPC 是为了性能，而决定性能的主要因素是序列化效率和信息密度，传输协议的层次越高，信息密度越低，不直接给予 TCP（传输层），是因为 HTTP/2 的核心优势：多路复用+头部压缩，并且还不用自己处理连接管理和流控等，即 HTTP/2 带来的便利性和功能性，弥补了高层次性能损失。
- 如何确认方法
通过 HTTP/2 头部标识中的完整路径格式，完整路径格式=包名+服务名+方法名

现代 RPC 的发展是分裂的，朝着面向对象、性能、简化… … 不同方向发展，近年，RPC 框架朝着更高层次抽象去发展了，不仅负责远程服务调用，还负责管理远程服务，例如阿里的 Dubbo，而这些都是根据的业务场景去选择的 :-)